<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.market.scms.dao.SupplierDao">
    <select id="querySupplierByPhone" resultType="com.market.scms.entity.Supplier">
        SELECT 
        *
        FROM 
        tb_supplier
        WHERE 
        supplier_phone = #{supplierPhone}
    </select>

    <select id="querySupplierByCondition" resultType="com.market.scms.entity.Supplier">
        SELECT 
        *
        FROM 
        tb_supplier s
        <where>
            <if test="supplierCondition.supplierName != null">
                AND
                s.supplier_name
                LIKE
                '%${supplierCondition.supplierName}%'
            </if>
            <if test="supplierCondition.supplierId != null">
                AND
                s.supplier_id = #{supplierCondition.supplierId}
            </if>
            <if test="supplierCondition.supplierPhone != null">
                AND
                s.supplier_phone = #{supplierCondition.supplierPhone}
            </if>
            <if test="supplierCondition.supplierFax != null">
                AND
                s.supplier_fax = #{supplierCondition.supplierFax}
            </if>
            <if test="supplierCondition.supplierStatus != null">
                AND
                s.supplier_status = #{supplierCondition.supplierStatus}
            </if>
            <if test="supplierCondition.supplierPayment != null">
                AND
                s.supplier_payment = #{supplierCondition.supplierPayment}
            </if>
        </where>
        ORDER BY supplier_id ASC 
        LIMIT #{rowIndex},#{pageSize}
    </select>

    <insert id="insertSupplier" parameterType="com.market.scms.entity.Supplier"
            useGeneratedKeys="true" keyProperty="supplierId" keyColumn="supplier_id">
        INSERT INTO
        tb_supplier(supplier_name,supplier_password,supplier_phone,
        supplier_address,supplier_email,supplier_fax,create_time,last_edit_time,
        supplier_status,supplier_payment,supplier_token,supplier_login_time,supplier_expire_time)
        VALUES 
        (#{supplierName},#{supplierPassword},#{supplierPhone},#{supplierAddress},
        #{supplierEmail},#{supplierFax},#{createTime},#{lastEditTime},
        #{supplierStatus},#{supplierPayment},#{token},#{loginTime},#{expireTime})
    </insert>

    <update id="updateSupplier" parameterType="com.market.scms.entity.Supplier">
        UPDATE
        tb_supplier
        <set>
            <if test="supplierPassword != null"> supplier_password = #{supplierPassword},</if>
            <if test="supplierName != null"> supplier_name = #{supplierName},</if>
            <if test="supplierAddress != null"> supplier_address = #{supplierAddress},</if>
            <if test="supplierEmail != null"> supplier_email = #{supplierEmail},</if>
            <if test="supplierFax != null"> supplier_fax = #{supplierFax},</if>
            <if test="supplierPayment != null"> supplier_payment = #{supplierPayment},</if>
            <if test="lastEditTime != null"> last_edit_time = #{lastEditTime},</if>
            <if test="token != null"> supplier_token = #{token},</if>
            <if test="loginTime != null"> supplier_login_time = #{loginTime},</if>
            <if test="expireTime != null"> supplier_expire_time = #{expireTime}</if>
        </set>
        WHERE
        supplier_id = #{supplierId}
    </update>

    <select id="supplierLogin" resultType="com.market.scms.entity.Supplier">
        SELECT 
        *
        FROM 
        tb_supplier
        WHERE 
        supplier_phone = #{supplierPhone}
        AND 
        supplier_password = #{supplierPassword}
    </select>

    <select id="findByToken" resultType="com.market.scms.entity.Supplier">
        SELECT 
        *
        FROM 
        tb_supplier
        WHERE 
        supplier_token = #{token}
    </select>

</mapper>